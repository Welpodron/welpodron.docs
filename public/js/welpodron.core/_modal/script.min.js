"use strict";(s=>{if(s.welpodron&&s.welpodron.animate&&!s.welpodron.modal){var e="data-w-modal";const n=e+"-id",i=e+"-active",o=e+"-control";o;const l=e+"-action";l,l;class t{supportedActions=["hide","show"];element;lastFocusedElement;firstFocusableElement;lastFocusableElement;isTranslating=!1;isActive=!1;isOnce=!1;constructor({element:e,config:t={}}){this.element=e,null!=t.isOnce?this.isOnce=t.isOnce:this.isOnce=null!=this.element.getAttribute("data-w-modal-once"),this.isActive=null!=this.element.getAttribute(i),this.lastFocusedElement=document.activeElement,this.firstFocusableElement=document.createElement("div"),this.firstFocusableElement.setAttribute("data-w-modal-content",""),this.firstFocusableElement.tabIndex=0,this.lastFocusableElement=document.createElement("button"),this.lastFocusableElement.style.cssText="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0;",this.lastFocusableElement.onfocus=()=>this.firstFocusableElement.focus(),this.firstFocusableElement.append(...this.element.childNodes),this.element.append(this.firstFocusableElement),this.element.append(this.lastFocusableElement),document.removeEventListener("click",this.handleDocumentClick),document.addEventListener("click",this.handleDocumentClick)}handleDocumentClick=e=>{let t=e["target"];var s,i;if(t)return t===this.element?this.hide({event:e}):(t=t.closest(`[${n}="${this.element.getAttribute(n)}"][${o}][${l}]`))&&(i=t.getAttribute(l),s=t.getAttribute("data-w-modal-action-args"),t.getAttribute("data-w-modal-action-flush")||e.preventDefault(),i)&&this.supportedActions.includes(i)&&(i=this[i])instanceof Function?(this.element.contains(t)||(this.lastFocusedElement=t),i({args:s,event:e})):void 0};handleDocumentKeyDown=e=>{if("Tab"===e.code&&e.shiftKey)return e.target===this.firstFocusableElement?(e.preventDefault(),this.lastFocusableElement.focus()):void 0;var t;"Escape"===e.key&&s.welpodron.modalsListActive.size&&!(t=[...s.welpodron.modalsListActive][s.welpodron.modalsListActive.size-1]).isTranslating&&t.hide({event:e})};show=async({})=>{this.isTranslating||this.isActive||(this.element.parentNode&&document.body.append(this.element),this.isTranslating=!0,document.body.style.overflow="hidden",document.body.style.touchAction="pinch-zoom",this.element.style.display="flex",this.element.scrollHeight,this.element.style.inset="",await s.welpodron.animate({element:this.element,callback:()=>{this.element.setAttribute(i,"")}}).promise,document.removeEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.firstFocusableElement.focus(),s.welpodron.modalsListActive.add(this),this.isTranslating=!1,this.isActive=!0)};hide=async({})=>{!this.isTranslating&&this.isActive&&(this.isTranslating=!0,await s.welpodron.animate({element:this.element,callback:()=>{this.element.removeAttribute(i)}}).promise,this.element.style.display="none",s.welpodron.modalsListActive.delete(this),s.welpodron.modalsListActive.size||(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("touch-action")),document.removeEventListener("keydown",this.handleDocumentKeyDown),this.lastFocusedElement?.focus(),document.activeElement!==this.lastFocusedElement&&s.welpodron.modalsListActive.size&&[...s.welpodron.modalsListActive].pop().firstFocusableElement.focus(),this.isOnce&&(document.removeEventListener("click",this.handleDocumentClick),this.element.remove()),this.isTranslating=!1,this.isActive=!1)}}s.welpodron.modal=t,s.welpodron.modalsListActive=new Set}})(window);
//# sourceMappingURL=script.min.js.map