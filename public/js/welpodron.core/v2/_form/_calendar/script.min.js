"use strict";(e=>{if(e.welpodron||(e.welpodron={}),e.welpodron.form||(e.welpodron.form={}),!e.welpodron.form["input-calendar"]){var t="input-calendar",t="data-w-"+t;const l=t+"-id",i=t+"-input",d=(i,t+"-control");d;const c=t+"-action",s=c+"-args";c;class a{calendar;constructor({calendar:e}){this.calendar=e}render=()=>{var e=document.createElement("div");e.setAttribute("data-w-input-calendar-head","");let t=document.createElement("button");var a=new Date(this.calendar.activeDate.getFullYear(),this.calendar.activeDate.getMonth(),1),a=(a.setDate(a.getDate()-1),t.innerText="<",t.setAttribute("type","button"),this.calendar.currentDate.getTime()>a.getTime()?t.setAttribute("disabled",""):(t.setAttribute(s,"-1"),t.setAttribute(c,"changeMonth"),t.setAttribute(d,""),t.setAttribute(l,this.calendar.element.getAttribute(l))),e.appendChild(t),document.createElement("p"));let n=document.createElement("span");return n.innerText=this.calendar.activeDate.toLocaleString("ru-RU",{month:"long"}),a.appendChild(n),(n=document.createElement("span")).innerText=this.calendar.activeDate.getFullYear().toString(),a.appendChild(n),e.appendChild(a),(t=document.createElement("button")).setAttribute("type","button"),t.setAttribute(s,"1"),t.setAttribute(c,"changeMonth"),t.setAttribute(d,""),t.setAttribute(l,this.calendar.element.getAttribute(l)),t.innerText=">",e.appendChild(t),e}}class n{calendar;constructor({calendar:e}){this.calendar=e}render=()=>{var e=document.createElement("table"),t=(e.setAttribute("data-w-input-calendar-table",""),document.createElement("thead"));const a=document.createElement("tr"),n=(["Пн","Вт","Ср","Чт","Пт","Сб","Вс"].forEach(e=>{var t=document.createElement("th");t.innerText=e,a.appendChild(t)}),t.appendChild(a),e.appendChild(t),document.createElement("tbody"));return this.calendar.getPanel({year:this.calendar.activeDate.getFullYear(),month:this.calendar.activeDate.getMonth()}).forEach(e=>{const i=document.createElement("tr");e.forEach(e=>{var t,a=document.createElement("td"),n=e.getDate()<10?"0"+e.getDate():e.getDate().toString(),r=e.getMonth()+1<10?"0"+(e.getMonth()+1):(e.getMonth()+1).toString();this.calendar.activeDate.getMonth()===e.getMonth()&&(t=document.createElement("button"),this.calendar.currentDate.getTime()>e.getTime()?t.setAttribute("disabled",""):(t.setAttribute(s,e.getFullYear()+`-${r}-`+n),t.setAttribute(c,"changeDate"),t.setAttribute(d,""),t.setAttribute(l,this.calendar.element.getAttribute(l))),t.setAttribute("type","button"),t.innerText=n,a.appendChild(t)),i.appendChild(a)}),n.appendChild(i)}),e.appendChild(n),e}}e.welpodron.form["input-calendar"]=class{element;head;table;supportedActions=["changeMonth","changeDate"];currentDate;savedDate=null;activeDate;constructor({element:e}){var t=new Date;t.setHours(0,0,0,0),this.currentDate=t,this.activeDate=new Date(t),this.element=e,this.head=new a({calendar:this}),this.table=new n({calendar:this}),this.element.appendChild(this.head.render()),this.element.appendChild(this.table.render()),document.removeEventListener("click",this.handleDocumentClick),document.addEventListener("click",this.handleDocumentClick)}handleDocumentClick=e=>{let t=e["target"];var a,n;if(t&&(t=t.closest(`[${l}="${this.element.getAttribute(l)}"][${d}][${c}]`)))return n=t.getAttribute(c),a=t.getAttribute(s),t.getAttribute("data-w-input-calendar-action-flush")||e.preventDefault(),n&&this.supportedActions.includes(n)&&(n=this[n])instanceof Function?n({args:a,event:e}):void 0};changeMonth=async({args:e})=>{if(this.activeDate.setMonth(this.activeDate.getMonth()+parseInt(e)),"function"==typeof this.element.replaceChildren)return this.element.replaceChildren(this.head.render(),this.table.render());this.element.innerHTML="",this.element.appendChild(this.head.render()),this.element.appendChild(this.table.render())};changeDate=async({args:a})=>{var e=a.split("-").map(e=>parseInt(e)).filter(e=>!isNaN(e)),[t,n,r]=e,e=(e.length<3?this.savedDate=null:this.savedDate=new Date(t,n-1,r),new CustomEvent("welpodron.form.input-calendar:changeDate:after",{bubbles:!0,cancelable:!1,detail:{date:this.savedDate?new Date(this.savedDate):null}}));this.element.dispatchEvent(e),document.querySelectorAll(`[${l}="${this.element.getAttribute(l)}"][${i}]`).forEach(e=>{e.hasAttribute("data-w-input-calendar-input-formatted")?this.savedDate?e.setAttribute("value",this.savedDate?.toLocaleString("ru",{year:"numeric",month:"long",day:"numeric"})):e.setAttribute("value",""):this.savedDate?e.setAttribute("value",a):e.setAttribute("value","");var t=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)})};getPanel=({year:t,month:a})=>{var n=[],r=[];let i=new Date(t,a,1).getDay();0===i&&(i=7);for(let e=-1*(i-=2);e<=0;e++){var l=new Date(t,a,e);n.push(l)}var d=42-i;for(let e=1;e<d;e++){var c=new Date(t,a,e);n.push(c)}for(let e=0;e<n.length;e+=7)r.push(n.slice(e,e+7));return r}}}})(window);
//# sourceMappingURL=script.min.js.map