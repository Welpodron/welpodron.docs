"use strict";(h=>{if(h.welpodron||(h.welpodron={}),!h.welpodron.popover){const i="data-w-popover",s=i+"-id",n=i+"-active";i;i,i;const o=i+"-control";o;const r=i+"-action",l=r+"-args",c=r+"-flush";h.welpodron.popover=class{supportedActions=["hide","show"];isHoverable=!1;hoverableLeaveTimeout=null;isActive=!1;element;lastFocusedElement;resizeObserver;currentAnchor;constructor({element:e,config:t={}}){this.element=e,this.isActive=null!=this.element.getAttribute(n),this.isHoverable=null!=this.element.getAttribute("data-w-popover-hoverable")||!0===t.isHoverable,this.lastFocusedElement=document.activeElement,this.resizeObserver=new ResizeObserver((e,t)=>{for(const i of e)this.currentAnchor&&this.calculatePosition({anchor:this.currentAnchor})}),this.isHoverable?(document.removeEventListener("mouseover",this.handleDocumentMouseOver),document.addEventListener("mouseover",this.handleDocumentMouseOver),document.removeEventListener("mouseout",this.handleDocumentMouseOut),document.addEventListener("mouseout",this.handleDocumentMouseOut)):(document.removeEventListener("click",this.handleDocumentClick),document.addEventListener("click",this.handleDocumentClick))}calculatePosition=({anchor:e})=>{var{width:e,height:t,left:i,top:n}=e.getBoundingClientRect(),t=(this.element.style.left=i+h.scrollX+"px",this.element.style.top=n+t+h.scrollY+"px",document.documentElement.clientHeight),s=document.documentElement.clientWidth,{width:o,height:r,left:l,top:c}=this.element.getBoundingClientRect();Math.ceil(l+o)>=s&&(this.element.style.left=i+h.scrollX-o+e+"px"),Math.ceil(c+r)>=t&&(this.element.style.top=n+h.scrollY-r+"px")};show=async({event:t})=>{var e;!this.isActive&&(document.body.append(this.element),e=[...document.querySelectorAll(`[${o}][${r}][${s}="${this.element.getAttribute(s)}"]:not([${i}][${s}="${this.element.getAttribute(s)}"] *)`)].find(e=>e.contains(t?.target)))&&(this.currentAnchor=e,this.resizeObserver.observe(this.element),this.resizeObserver.observe(e),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("keydown",this.handleDocumentKeyDown),h.removeEventListener("resize",this.handleWindowResize),h.addEventListener("resize",this.handleWindowResize),this.element.setAttribute(n,""),this.calculatePosition({anchor:e}),this.isActive=!0)};hide=async({})=>{this.isActive&&(this.resizeObserver.disconnect(),document.removeEventListener("keydown",this.handleDocumentKeyDown),this.lastFocusedElement?.focus(),this.element.removeAttribute(n),this.isActive=!1)};handleDocumentKeyDown=e=>{if("Escape"===e.key)return this.hide({event:e})};handleWindowResize=e=>{this.isActive&&this.calculatePosition({anchor:this.currentAnchor})};handleDocumentClick=e=>{var t,i,n=e["target"];if(n)return n.closest(`[${s}="${this.element.getAttribute(s)}"][${o}][${r}]`)?(i=n.getAttribute(r),t=n.getAttribute(l),n.getAttribute(c)||e.preventDefault(),i&&this.supportedActions.includes(i)&&(i=this[i])instanceof Function?(this.element.contains(n)||(this.lastFocusedElement=n),i({args:t,event:e})):void 0):document.contains(n)&&!this.element.contains(n)?this.hide({event:e}):void 0};handleDocumentMouseOver=async e=>{var t=e["target"];if(t){var i,n,t=t.closest(`[${s}="${this.element.getAttribute(s)}"][${o}][${r}]`);if(t)return null!=this.hoverableLeaveTimeout&&clearTimeout(this.hoverableLeaveTimeout),n=t.getAttribute(r),i=t.getAttribute(l),t.getAttribute(c)||e.preventDefault(),n&&this.supportedActions.includes(n)&&(n=this[n])instanceof Function?(this.element.contains(t)||(this.lastFocusedElement=t),n({args:i,event:e})):void 0}};handleDocumentMouseOut=async e=>{let t=e["relatedTarget"];null!=this.hoverableLeaveTimeout&&clearTimeout(this.hoverableLeaveTimeout),this.hoverableLeaveTimeout=setTimeout(()=>t&&this.element.contains(t)?void 0:this.hide({}),125)}}}})(window);
//# sourceMappingURL=script.min.js.map